# 支付宝收款开通完整指南

## 🎯 开通支付宝收款用于点数包和会员订阅支付

本指南将帮助您开通支付宝收款功能，支持用户购买点数包（30点¥9、100点¥27、300点¥66）和会员订阅（专业版、全能版）。

---

## 📋 准备工作清单

### 必需材料
- ✅ **营业执照**（企业/个体工商户）
- ✅ **法人身份证**
- ✅ **银行账户**（对公账户或法人银行卡）
- ✅ **网站域名**（已备案）
- ✅ **联系方式**（手机号、邮箱）

### 技术准备
- ✅ **开发能力**（已完成 - 您的代码已实现）
- ✅ **服务器环境**（HTTPS必需）
- ✅ **域名备案**（必需）

---

## 🚀 第一步：注册支付宝开放平台账号

### 1.1 访问官网
- 网址：https://open.alipay.com/
- 点击右上角「注册」

### 1.2 选择账号类型
```
推荐选择：企业账号
- 个体工商户也选择"企业账号"
- 个人开发者无法开通收款功能
```

### 1.3 填写注册信息
- **账号类型**：企业账号
- **联系人**：法人或授权人
- **手机号**：用于接收验证码
- **邮箱**：重要通知接收邮箱

---

## 🏢 第二步：企业认证

### 2.1 选择认证方式
```
推荐方式：企业支付宝账号认证
- 最快捷，1-2个工作日
- 需要有企业支付宝账号
```

### 2.2 上传认证材料
**营业执照信息：**
- 营业执照扫描件/照片
- 统一社会信用代码
- 企业名称（必须与营业执照完全一致）
- 营业期限

**法人信息：**
- 法人姓名
- 法人身份证正反面
- 法人手机号

**银行账户信息：**
- 对公银行账户（推荐）
- 开户银行
- 银行账号

### 2.3 等待审核
- 审核时间：1-3个工作日
- 可在控制台查看审核进度
- 审核结果将通过短信/邮件通知

---

## 💰 第三步：申请电脑网站支付功能

### 3.1 登录开发者控制台
- 登录：https://open.alipay.com/
- 进入「控制台」

### 3.2 创建应用
**应用信息：**
- **应用名称**：AI画芽空间
- **应用类型**：网页/移动应用
- **应用环境**：线上环境
- **行业类目**：软件/IT服务

**应用描述：**
```
AI图像生成平台，提供点数包充值和会员订阅服务：
- 点数包：30点(¥9)、100点(¥27)、300点(¥66)
- 会员订阅：专业版、全能版，支持月付/年付
```

### 3.3 添加功能包
- 搜索「电脑网站支付」
- 点击「立即添加」
- 填写功能说明

**功能用途说明：**
```
用于AI图像生成平台的充值服务：
1. 用户购买点数包进行图像生成
2. 用户订阅会员套餐获得高级功能
3. 支付金额范围：¥9-¥590
4. 主要用户群体：设计师、创作者、企业用户
```

---

## 🔧 第四步：技术配置

### 4.1 生成应用密钥

**RSA2密钥生成：**
```bash
# 下载支付宝密钥生成工具
# 或使用在线工具：https://miniu.alipay.com/keytool/create

# 生成2048位RSA密钥对
openssl genrsa -out app_private_key.pem 2048
openssl rsa -in app_private_key.pem -pubout -out app_public_key.pem
```

### 4.2 上传公钥到支付宝
1. 复制 `app_public_key.pem` 内容
2. 在应用详情页面 → 「开发设置」
3. 上传「应用公钥」
4. 获取「支付宝公钥」

### 4.3 配置回调地址
```
异步通知地址：https://yourdomain.com/api/payment/alipay/notify
同步跳转地址：https://yourdomain.com/payment/success
```

### 4.4 记录应用信息
```
APPID：应用的唯一标识（如：2021xxxxxxxxxx）
应用私钥：app_private_key.pem 内容
支付宝公钥：从支付宝开放平台获取
网关地址：https://openapi.alipay.com/gateway.do
```

---

## 🌐 第五步：配置您的网站

### 5.1 更新环境变量
在您的 `.env.local` 文件中添加：

```bash
# 支付宝支付配置
ALIPAY_APP_ID=2021xxxxxxxxxx
ALIPAY_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----
MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQC+...
-----END PRIVATE KEY-----"
ALIPAY_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3...
-----END PUBLIC KEY-----"
ALIPAY_GATEWAY=https://openapi.alipay.com/gateway.do

# 应用基础URL
NEXT_PUBLIC_BASE_URL=https://yourdomain.com
```

### 5.2 部署到生产环境
```bash
# 构建项目
npm run build

# 部署到服务器（确保HTTPS）
# 您的代码已经包含完整的支付宝支付功能
```

---

## 🧪 第六步：测试支付功能

### 6.1 沙箱环境测试
支付宝提供沙箱环境进行测试：

**沙箱配置：**
```bash
ALIPAY_GATEWAY=https://openapi.alipaydev.com/gateway.do
# 使用沙箱APPID和密钥
```

**测试用支付宝账号：**
- 买家账号：sandbox_buyer@example.com
- 登录密码：111111
- 支付密码：111111

### 6.2 测试流程
1. 在您的网站选择点数包或会员套餐
2. 选择支付宝支付
3. 使用测试账号完成支付
4. 验证回调处理正常
5. 检查支付成功页面

---

## 🔍 第七步：申请上线审核

### 7.1 提交上线申请
- 在开发者控制台提交上线申请
- 等待支付宝审核（通常1-3个工作日）

### 7.2 审核要求
**网站要求：**
- ✅ 网站可正常访问
- ✅ 使用HTTPS协议
- ✅ 域名已备案
- ✅ 支付流程完整

**业务要求：**
- ✅ 明确的商品/服务说明
- ✅ 合理的价格设置
- ✅ 用户协议和隐私政策
- ✅ 客服联系方式

---

## 💡 常见问题解答

### Q1: 个人可以申请支付宝收款吗？
**A:** 个人开发者无法开通「电脑网站支付」功能，必须是企业或个体工商户。

### Q2: 需要什么资质？
**A:** 
- 营业执照（企业/个体工商户）
- 银行账户（对公账户或法人银行卡）
- 网站域名（已备案）

### Q3: 手续费是多少？
**A:** 
- 电脑网站支付：0.6%
- 无其他隐藏费用
- T+1结算（下一个工作日到账）

### Q4: 多久能开通？
**A:** 
- 企业认证：1-3个工作日
- 功能申请：1-2个工作日
- 总计：3-5个工作日

### Q5: 支付限额是多少？
**A:** 
- 单笔支付：最高5万元
- 符合您的点数包和会员价格范围

---

## 🎯 产品价格配置

您的代码已配置以下产品：

**点数包：**
- 30点 - ¥9.00
- 100点 - ¥27.00  
- 300点 - ¥66.00

**会员订阅：**
- 专业版月付 - ¥29.00
- 专业版年付 - ¥290.00
- 全能版月付 - ¥59.00
- 全能版年付 - ¥590.00

---

## 📞 支持与帮助

### 官方支持
- **客服热线**：95188
- **服务时间**：8:00-24:00
- **在线客服**：支付宝开放平台控制台

### 技术支持
- **文档中心**：https://opendocs.alipay.com/
- **API文档**：详细的接口说明
- **社区论坛**：开发者交流

### 紧急问题
如遇到紧急问题，可通过以下方式联系：
1. 开发者控制台提交工单
2. 拨打客服热线说明情况
3. 发送邮件到技术支持邮箱

---

## ✅ 开通完成检查清单

- [ ] 注册支付宝开放平台账号
- [ ] 完成企业认证
- [ ] 创建应用并添加「电脑网站支付」功能
- [ ] 生成并配置RSA2密钥
- [ ] 设置回调地址
- [ ] 配置环境变量
- [ ] 沙箱环境测试通过
- [ ] 提交上线申请
- [ ] 审核通过，正式开通
- [ ] 生产环境测试正常

**恭喜！🎉 您的支付宝收款功能已成功开通！**

用户现在可以通过支付宝购买您的点数包和会员订阅服务了。 